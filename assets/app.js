angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationController",["$scope",function(o){o.$on("login",function(t,n){o.currentUser=n})}]),angular.module("app").controller("LoginController",["$scope","UserService","$location",function(o,t,n){o.login=function(e,r){t.login(e,r).then(function(t){o.$emit("login",t.data),n.path("/")})}}]),angular.module("app").controller("PostsController",["$scope","PostsService",function(o,t){t.fetch().success(function(t){o.posts=t}),o.addPost=function(){o.postBody&&t.create({username:"jayplabs",body:o.postBody}).success(function(){o.postBody=null})},o.$on("ws:new_post",function(t,n){o.$apply(function(){o.posts.unshift(n)})})}]),angular.module("app").service("PostsService",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsController",templateUrl:"posts.html"}).when("/register",{controller:"RegisterController",templateUrl:"register.html"}).when("/login",{controller:"LoginController",templateUrl:"login.html"})}]),angular.module("app").service("UserService",["$http",function(o){var t=this;t.getUser=function(){return o.get("/api/users")},t.login=function(n,e){return o.post("/api/sessions",{username:n,password:e}).then(function(n){return t.token=n.data,o.defaults.headers.common["X-Auth"]=n.data,t.getUser()})}}]),angular.module("app").run(["$rootScope",function(o){var t="ws://localhost:3000",n=new WebSocket(t);n.onopen=function(){console.log("WebSocket connected")},n.onmessage=function(t){var n=JSON.parse(t.data);o.$broadcast("ws:"+n.topic,n.data)}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmNvbnRyb2xsZXIuanMiLCJsb2dpbi5jb250cm9sbGVyLmpzIiwicG9zdHMuY29udHJvbGxlci5qcyIsInBvc3RzLnNlcnZpY2UuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnNlcnZpY2UuanMiLCJ3ZWJzb2NrZXRzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsIlVzZXJTZXJ2aWNlIiwiJGxvY2F0aW9uIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInJlc3BvbnNlIiwiJGVtaXQiLCJkYXRhIiwicGF0aCIsIlBvc3RzU2VydmljZSIsImZldGNoIiwic3VjY2VzcyIsInBvc3RzIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInBvc3QiLCIkYXBwbHkiLCJ1bnNoaWZ0Iiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiZ2V0VXNlciIsInRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwicnVuIiwiJHJvb3RTY29wZSIsInVybCIsImNvbm5lY3Rpb24iLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJjb25zb2xlIiwibG9nIiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFBQyxPQUFBLE9BQ0EsWUNEQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLHlCQUFBLFNBQUEsU0FBQUMsR0FDQUEsRUFBQUMsSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdBQ0FILEVBQUFJLFlBQUFELE9DSEFOLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxTQUFBLGNBQUEsWUFBQSxTQUFBQyxFQUFBSyxFQUFBQyxHQUNBTixFQUFBTyxNQUFBLFNBQUFDLEVBQUFDLEdBQ0FKLEVBQUFFLE1BQUFDLEVBQUFDLEdBQ0FDLEtBQUEsU0FBQUMsR0FDQVgsRUFBQVksTUFBQSxRQUFBRCxFQUFBRSxNQUNBUCxFQUFBUSxLQUFBLFdDTkFqQixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsbUJBQUEsU0FBQSxlQUFBLFNBQUFDLEVBQUFlLEdBQ0FBLEVBQUFDLFFBQUFDLFFBQUEsU0FBQUMsR0FDQWxCLEVBQUFrQixNQUFBQSxJQUdBbEIsRUFBQW1CLFFBQUEsV0FDQW5CLEVBQUFvQixVQUNBTCxFQUFBTSxRQUNBYixTQUFBLFdBQ0FjLEtBQUF0QixFQUFBb0IsV0FDQUgsUUFBQSxXQUNBakIsRUFBQW9CLFNBQUEsUUFLQXBCLEVBQUFDLElBQUEsY0FBQSxTQUFBQyxFQUFBcUIsR0FDQXZCLEVBQUF3QixPQUFBLFdBQ0F4QixFQUFBa0IsTUFBQU8sUUFBQUYsVUNuQkExQixRQUFBQyxPQUFBLE9BQ0E0QixRQUFBLGdCQUFBLFFBQUEsU0FBQUMsR0FDQUMsS0FBQVosTUFBQSxXQUNBLE1BQUFXLEdBQUFFLElBQUEsZUFFQUQsS0FBQVAsT0FBQSxTQUFBRSxHQUNBLE1BQUFJLEdBQUFKLEtBQUEsYUFBQUEsT0NOQTFCLFFBQUFDLE9BQUEsT0FDQWdDLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsS0FBQSxLQUFBakMsV0FBQSxrQkFBQWtDLFlBQUEsZUFDQUQsS0FBQSxhQUFBakMsV0FBQSxxQkFBQWtDLFlBQUEsa0JBQ0FELEtBQUEsVUFBQWpDLFdBQUEsa0JBQUFrQyxZQUFBLGtCQ0xBcEMsUUFBQUMsT0FBQSxPQUNBNEIsUUFBQSxlQUFBLFFBQUEsU0FBQUMsR0FDQSxHQUFBRCxHQUFBRSxJQUNBRixHQUFBUSxRQUFBLFdBQ0EsTUFBQVAsR0FBQUUsSUFBQSxlQUdBSCxFQUFBbkIsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFrQixHQUFBSixLQUFBLGlCQUNBZixTQUFBQSxFQUFBQyxTQUFBQSxJQUNBQyxLQUFBLFNBQUFDLEdBR0EsTUFGQWUsR0FBQVMsTUFBQXhCLEVBQUFFLEtBQ0FjLEVBQUFTLFNBQUFDLFFBQUFDLE9BQUEsVUFBQTNCLEVBQUFFLEtBQ0FhLEVBQUFRLGdCQ2JBckMsUUFBQUMsT0FBQSxPQUNBeUMsS0FBQSxhQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQSxzQkFDQUMsRUFBQSxHQUFBQyxXQUFBRixFQUVBQyxHQUFBRSxPQUFBLFdBQ0FDLFFBQUFDLElBQUEsd0JBR0FKLEVBQUFLLFVBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBQyxLQUFBQyxNQUFBSCxFQUFBbkMsS0FDQTJCLEdBQUFZLFdBQUEsTUFBQUgsRUFBQUksTUFBQUosRUFBQXBDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgJ25nUm91dGUnXG5dKVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25Db250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSkge1xuICAgICRzY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24gKF8sIHVzZXIpIHtcbiAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxuICAgIH0pXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTZXJ2aWNlLCAkbG9jYXRpb24pIHtcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgVXNlclNlcnZpY2UubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKVxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxuICAgICAgICB9KVxuICAgIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdQb3N0c0NvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUsIFBvc3RzU2VydmljZSkge1xuICAgIFBvc3RzU2VydmljZS5mZXRjaCgpLnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG4gICAgICAgICRzY29wZS5wb3N0cyA9IHBvc3RzXG4gICAgfSlcblxuICAgICRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG4gICAgICAgICAgICBQb3N0c1NlcnZpY2UuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogJ2pheXBsYWJzJyxcbiAgICAgICAgICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5wb3N0Qm9keSA9IG51bGxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uIChfLCBwb3N0KSB7XG4gICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICAgICAgfSlcbiAgICB9KVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCkge1xuICAgIHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycpXG4gICAgfVxuICAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCkge1xuICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpXG4gICAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlclxuICAgIC53aGVuKCcvJywgeyBjb250cm9sbGVyOiAnUG9zdHNDb250cm9sbGVyJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ30pXG4gICAgLndoZW4oJy9yZWdpc3RlcicsIHtjb250cm9sbGVyOiAnUmVnaXN0ZXJDb250cm9sbGVyJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ30pXG4gICAgLndoZW4oJy9sb2dpbicsIHtjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJ30pXG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHApIHtcbiAgICB2YXIgc2VydmljZSA9IHRoaXNcbiAgICBzZXJ2aWNlLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxuICAgIH1cblxuICAgIHNlcnZpY2UubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHNlcnZpY2UudG9rZW4gPSByZXNwb25zZS5kYXRhXG4gICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSByZXNwb25zZS5kYXRhXG4gICAgICAgICAgICByZXR1cm4gc2VydmljZS5nZXRVc2VyKClcbiAgICAgICAgfSlcbiAgICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XG4gIHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAwMCdcbiAgdmFyIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybClcblxuICBjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zb2xlLmxvZygnV2ViU29ja2V0IGNvbm5lY3RlZCcpXG4gIH1cblxuICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSlcbiAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpXG4gIH1cbn0pXG4iXX0=
